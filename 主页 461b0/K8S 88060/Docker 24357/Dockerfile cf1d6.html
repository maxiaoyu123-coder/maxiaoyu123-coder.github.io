<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Dockerfile</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	text-indent: -1.7em;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
}

.simple-table-header {
	background: rgb(247, 246, 243);
	color: black;
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(55, 53, 47, 1);
}
.highlight-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.highlight-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.highlight-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.highlight-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.highlight-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.highlight-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.highlight-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.highlight-gray_background {
	background: rgba(241, 241, 239, 1);
}
.highlight-brown_background {
	background: rgba(244, 238, 238, 1);
}
.highlight-orange_background {
	background: rgba(251, 236, 221, 1);
}
.highlight-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.highlight-teal_background {
	background: rgba(237, 243, 236, 1);
}
.highlight-blue_background {
	background: rgba(231, 243, 248, 1);
}
.highlight-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.highlight-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.highlight-red_background {
	background: rgba(253, 235, 236, 1);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.block-color-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.block-color-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.block-color-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.block-color-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.block-color-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.block-color-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.block-color-gray_background {
	background: rgba(241, 241, 239, 1);
}
.block-color-brown_background {
	background: rgba(244, 238, 238, 1);
}
.block-color-orange_background {
	background: rgba(251, 236, 221, 1);
}
.block-color-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.block-color-teal_background {
	background: rgba(237, 243, 236, 1);
}
.block-color-blue_background {
	background: rgba(231, 243, 248, 1);
}
.block-color-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.block-color-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.block-color-red_background {
	background: rgba(253, 235, 236, 1);
}
.select-value-color-pink { background-color: rgba(245, 224, 233, 1); }
.select-value-color-purple { background-color: rgba(232, 222, 238, 1); }
.select-value-color-green { background-color: rgba(219, 237, 219, 1); }
.select-value-color-gray { background-color: rgba(227, 226, 224, 1); }
.select-value-color-opaquegray { background-color: rgba(255, 255, 255, 0.0375); }
.select-value-color-orange { background-color: rgba(250, 222, 201, 1); }
.select-value-color-brown { background-color: rgba(238, 224, 218, 1); }
.select-value-color-red { background-color: rgba(255, 226, 221, 1); }
.select-value-color-yellow { background-color: rgba(253, 236, 200, 1); }
.select-value-color-blue { background-color: rgba(211, 229, 239, 1); }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="cf1d6784-b6c3-4b71-9ca8-91069f56e964" class="page sans"><header><img class="page-cover-image" src="Dockerfile%20cf1d6/dockerfile-930x600.png" style="object-position:center 50%"/><div class="page-header-icon page-header-icon-with-cover"><span class="icon">ğŸ‹</span></div><h1 class="page-title">Dockerfile</h1><table class="properties"><tbody><tr class="property-row property-row-created_time"><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesCreatedAt"><path d="M6.98643729,14.0000972 C5.19579566,14.0000972 3.40419152,13.3106896 2.04245843,11.9323606 C-0.681017475,9.21200555 -0.680780251,4.76029539 2.04293482,2.04012507 C4.76664406,-0.68004331 9.22427509,-0.68004331 11.9480135,2.04013479 C13.272481,3.36277455 14,5.1330091 14,6.99552762 C14,8.87640182 13.2721894,10.6285043 11.9480135,11.9509302 C10.5679344,13.3105924 8.77756503,14.0000972 6.98643729,14.0000972 Z M10.2705296,7.00913883 L10.2705296,8.46099754 L10.2705296,8.65543362 L10.076181,8.65543362 L8.6543739,8.65543362 L5.72059514,8.65543362 L5.52619796,8.65543362 L5.52619796,8.46099754 L5.52619796,5.52541044 L5.52619796,3.37946773 L5.52619796,3.18502193 L5.72059514,3.18502193 L7.17253164,3.18502193 L7.36692883,3.18502193 L7.36692883,3.37946773 L7.36692883,6.81467358 L10.076181,6.81467358 L10.2705296,6.81467358 L10.2705296,7.00913883 Z M12.1601539,6.99552762 C12.1601539,5.61697497 11.6190112,4.32597154 10.6393933,3.34769528 C8.63253764,1.34336744 5.35197452,1.34061603 3.34153136,3.33944106 C3.33868273,3.34219247 3.33607716,3.34494388 3.33322852,3.34769528 C1.32397148,5.35459953 1.32372842,8.63641682 3.33322852,10.6433794 C5.34295224,12.6504489 8.62968901,12.6504489 10.6393933,10.6433794 C11.6190112,9.66506426 12.1601539,8.37408027 12.1601539,6.99552762 Z"></path></svg></span>Created</th><td><time>@March 21, 2021 4:44 PM</time></td></tr><tr class="property-row property-row-multi_select"><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesMultipleSelect"><path d="M4,3 C4,2.447715 4.447715,2 5,2 L12,2 C12.5523,2 13,2.447716 13,3 C13,3.55228 12.5523,4 12,4 L5,4 C4.447715,4 4,3.55228 4,3 Z M4,7 C4,6.447715 4.447715,6 5,6 L12,6 C12.5523,6 13,6.447716 13,7 C13,7.55228 12.5523,8 12,8 L5,8 C4.447715,8 4,7.55228 4,7 Z M4,11 C4,10.447715 4.447715,10 5,10 L12,10 C12.5523,10 13,10.447716 13,11 C13,11.55228 12.5523,12 12,12 L5,12 C4.447715,12 4,11.55228 4,11 Z M2,4 C1.44771525,4 1,3.55228475 1,3 C1,2.44771525 1.44771525,2 2,2 C2.55228475,2 3,2.44771525 3,3 C3,3.55228475 2.55228475,4 2,4 Z M2,8 C1.44771525,8 1,7.55228475 1,7 C1,6.44771525 1.44771525,6 2,6 C2.55228475,6 3,6.44771525 3,7 C3,7.55228475 2.55228475,8 2,8 Z M2,12 C1.44771525,12 1,11.5522847 1,11 C1,10.4477153 1.44771525,10 2,10 C2.55228475,10 3,10.4477153 3,11 C3,11.5522847 2.55228475,12 2,12 Z"></path></svg></span>Tags</th><td></td></tr></tbody></table></header><div class="page-body"><nav id="2e10b293-efb9-4628-bebf-b72520108d81" class="block-color-blue table_of_contents"><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#8234d80a-dbf5-4d80-81f2-def4a3e0dee7"><strong>ä½¿ç”¨Dockerfileæ„å»ºé•œåƒ</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#dc89e6ab-9886-42f5-b673-48c184f525eb"><strong>æ­¥éª¤1</strong>: <strong>åˆ›å»ºä¸€ä¸ªç›®å½•, </strong>è¿™ä¸ªç›®å½•å°±æ˜¯<strong>æ„å»ºç¯å¢ƒ.</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#197ec491-2f4b-4991-b316-da72b33f7a78"><strong>æ­¥éª¤2</strong>: ç¼–è¾‘Dockerfileæ–‡ä»¶</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#7a1299a5-72c4-48c2-8c69-5c917ee270b6">æ­¥éª¤3: <strong>docker buildæ„å»ºæ–°é•œåƒ</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#d4fb9f11-ca04-4a84-af4f-116c51974c08">æ­¥éª¤4: <strong>å…±äº«å’Œå‘å¸ƒé•œåƒ</strong></a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#de99ff99-9451-4f16-9f3b-2925cf53dba7"><strong>DockerfileæŒ‡ä»¤</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#19cb3d95-789b-4734-952c-bfe605da4baa"><strong>CMD</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2a0abef7-f761-4b26-94ce-ae7ffae3b46d"><strong>ENTRYPOINT</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#e4263c4b-91e7-4bae-b483-30ab5a139d28"><strong>WORKDIR</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#9a15db89-4427-4118-b2e0-dd1ffcbaad32"><strong>ENV</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#5afaefe8-74ff-42bc-80e2-5e824b40e4f4"><strong>USER</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#6343c887-1e0a-4e30-a123-b4711505074c"><strong>VOLUME</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#dcfe53a7-3773-43f7-949f-49993b023dcd"><strong>ADD</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#aeae5f64-03dd-44e5-8f6d-84751635a513"><strong>COPY</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#09f79cdc-5a9a-4c8a-96ab-2c5368a6512e"><strong>LABEL</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#c01758c9-1d87-4c70-85de-4ace190bb6fd"><strong>STOPSIGNAL(è·³è¿‡)</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#d47b8259-40fc-43e9-ba56-43cace9f391f"><strong>ARG</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#82900873-7160-427b-ba40-c1403e6a31cb"><strong>ONBUILD(çœ‹åˆ°è¿™äº†)</strong></a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#4196e044-540e-4499-a54e-1bc06a3f17f1"><strong>å¤šé˜¶æ®µé•œåƒæ„å»ºæŠ€æœ¯</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#92efae4f-fa1b-4d06-8b85-f2f952cb825a"><strong>å®ç°</strong></a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#60b542ce-9938-4555-9c60-fc6c85f8b32c">shell formä¸ exec formåŒºåˆ«æ€»ç»“</a></div></nav><hr id="8bc631a8-76fb-42b4-84c0-454a730f826b"/><h1 id="8234d80a-dbf5-4d80-81f2-def4a3e0dee7" class="block-color-blue_background"><strong>ä½¿ç”¨Dockerfileæ„å»ºé•œåƒ</strong></h1><p id="89eadf20-9354-4acd-b810-ddfde1885360" class="">Dockerfileä½¿ç”¨åŸºäº<strong>DSL</strong>(Domain Specific Language)è¯­æ³•çš„æŒ‡ä»¤æ¥æ„å»ºDockeré•œåƒ, <strong>Dockerfileä¼˜ç‚¹æ˜¯æ›´å…·å¤‡å¯é‡å¤æ€§,é€æ˜æ€§ä»¥åŠå¹‚ç­‰æ€§.</strong></p><p id="0e1e58fd-7a14-43ce-8359-03b0eb3874f5" class="">
</p><h3 id="dc89e6ab-9886-42f5-b673-48c184f525eb" class="block-color-blue_background"><strong>æ­¥éª¤1</strong>: <strong>åˆ›å»ºä¸€ä¸ªç›®å½•, </strong>è¿™ä¸ªç›®å½•å°±æ˜¯<strong>æ„å»ºç¯å¢ƒ.</strong></h3><p id="b001e1d1-b408-406d-87fc-36d98560e16e" class="">Dockerä¼šåœ¨æ„å»ºé•œåƒæ—¶å°†ç›®å½•ä¸­çš„æ–‡ä»¶å’Œå­ç›®å½•ä¸Šä¼ åˆ°Dockerå®ˆæŠ¤è¿›ç¨‹. è¿™æ ·Dockerå®ˆæŠ¤è¿›ç¨‹å°±èƒ½ç›´æ¥è®¿é—®ç”¨æˆ·å¸Œæœ›åœ¨é•œåƒä¸­å­˜å‚¨çš„ä»»ä½•ä»£ç ,æ–‡ä»¶æˆ–è€…å…¶ä»–æ•°æ®.</p><pre id="e67489a5-3ef3-4d1f-bd88-0faba6b00341" class="code code-wrap"><code>Â [root@web02 ~]# mkdir static_web
Â [root@web02 ~]# cd static_web/
Â [root@web02 static_web]# touch Dockerfile</code></pre><p id="2b54e064-9fc6-42ec-9ad5-456fe8598d28" class="">
</p><h3 id="197ec491-2f4b-4991-b316-da72b33f7a78" class="block-color-blue_background"><strong>æ­¥éª¤2</strong>: ç¼–è¾‘Dockerfileæ–‡ä»¶</h3><p id="81ca21ea-b350-428e-b015-9bba56759c61" class="">è¯¥Dockerfileç”±ä¸€ç³»åˆ—æŒ‡ä»¤å’Œå‚æ•°ç»„æˆ. æ¯æ¡æŒ‡ä»¤éƒ½å¿…é¡»<strong>å¤§å†™</strong>, ä¸”åé¢è¦<strong>è·Ÿéšä¸€ä¸ªå‚æ•°</strong>, æ¯”å¦‚<code>FROM ubuntu:14.04</code>. Dockerfileä¸­çš„æŒ‡ä»¤ä¸Šåˆ°ä¸‹é€ä¸ªæ‰§è¡Œ, æ‰€ä»¥åº”è¯¥æ ¹æ®éœ€è¦åˆç†å®‰æ’æŒ‡ä»¤çš„é¡ºåº.</p><pre id="0043b96f-facf-4c81-b3f3-22612fa65698" class="code code-wrap"><code>Â [root@web02 static_web]# vim Dockerfile
Â FROM ubuntu:14.04
Â MAINTAINER maxiaoyu &quot;xiao_yu_ma@hotmail.com&quot;
Â RUN apt-get update &amp;&amp; apt-get install -y nginx
Â RUN echo &#x27;Hi, I am in your container&#x27; \
Â  Â   &gt;/usr/share/nginx/html/index.html
Â EXPOSE 80</code></pre><p id="2f37b403-3806-4bc0-b106-5038e9fbb96d" class=""><strong>æ¯æ¡æŒ‡ä»¤éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„é•œåƒå±‚å¹¶è¿›è¡Œæäº¤</strong>. Dockerå¤§ä½“ä¸ŠæŒ‰ç…§å¦‚ä¸‹æµç¨‹æ‰§è¡ŒDockerfileä¸­çš„æŒ‡ä»¤:</p><ul id="b1c63610-bd86-4395-ab02-6adfdd95b8cb" class="bulleted-list"><li style="list-style-type:disc">Dockerä»åŸºç¡€é•œåƒè¿è¡Œä¸€ä¸ªå®¹å™¨.</li></ul><ul id="063a7750-f92a-4141-b137-732d417fff36" class="bulleted-list"><li style="list-style-type:disc">æ‰§è¡Œä¸€æ¡æŒ‡ä»¤, å¯¹å®¹å™¨åšå‡ºä¿®æ”¹.</li></ul><ul id="ea225d54-a5d6-45f9-bb23-4be452b43c6f" class="bulleted-list"><li style="list-style-type:disc">æ‰§è¡Œç±»ä¼¼<code>docker commit</code>çš„æ“ä½œ, æäº¤ä¸€ä¸ªæ–°çš„é•œåƒå±‚.</li></ul><ul id="24edc106-f381-4c90-8919-84bc538366df" class="bulleted-list"><li style="list-style-type:disc">Dockeråœ¨åŸºäºåˆšæäº¤çš„é•œåƒè¿è¡Œä¸€ä¸ªæ–°å®¹å™¨.</li></ul><ul id="f546de6e-4ea5-4469-8990-90f952c9b44b" class="bulleted-list"><li style="list-style-type:disc">æ‰§è¡ŒDockerfileä¸­çš„ä¸‹ä¸€æ¡æŒ‡ä»¤, ç›´åˆ°æ‰€æœ‰æŒ‡ä»¤éƒ½æ‰§è¡Œå®Œæ¯•.</li></ul><p id="58982e76-93dc-41f5-8aa1-39e2db45ef1b" class="">å¦‚æœDockerfileç”±äºæŸäº›åŸå› æ²¡æœ‰æ­£å¸¸ç»“æŸ, é‚£ä¹ˆç”¨æˆ·å°†å¾—åˆ°ä¸€ä¸ªå¯ä»¥ä½¿ç”¨çš„é•œåƒ. è¿™å¯¹è°ƒè¯•éå¸¸æœ‰å¸®åŠ©: å¯ä»¥åŸºäºè¯¥é•œåƒè¿è¡Œä¸€ä¸ªå…·å¤‡äº¤äº’åŠŸèƒ½çš„å®¹å™¨, ä½¿ç”¨æœ€ååˆ›å»ºçš„é•œåƒå¯¹æŒ‡ä»¤ä¸ºä»€ä¹ˆä¼šå¤±è´¥è¿›è¡Œè°ƒæŸ¥.</p><p id="6c81a15e-fe21-4550-8996-dc282fc3db7e" class="">
</p><h3 id="7a1299a5-72c4-48c2-8c69-5c917ee270b6" class="block-color-blue_background">æ­¥éª¤3: <strong>docker buildæ„å»ºæ–°é•œåƒ</strong></h3><p id="a5c4fdbe-8fe6-4b2e-a41d-476cf36da86b" class="">æ‰§è¡Œ<code>docker build</code>å‘½ä»¤æ—¶, Dockerfileä¸­çš„æ‰€æœ‰æŒ‡ä»¤éƒ½ä¼šæ‰§è¡Œä¸”æäº¤, åœ¨è¯¥å‘½ä»¤æˆåŠŸç»“æŸåè¿”å›ä¸€ä¸ªæ–°é•œåƒ.</p><p id="9dc2fcb1-410a-44b0-b0d0-62a5ac076d51" class=""><strong>æŒ‡å®š</strong><code><strong>-t</strong></code><strong>é€‰é¡¹æ¥ä¸ºæ–°é•œåƒè®¾ç½®äº†ä»“åº“å’Œåç§°</strong>, æœ¬ä¾‹ä¸­ä»“åº“ä¸º<code>maxiaoyu</code>, é•œåƒåä¸º<code>static_web</code>. å¼ºçƒˆå»ºè®®ä¸ºé•œåƒè®¾ç½®åˆé€‚çš„åå­—ä»¥æ–¹ä¾¿è¿½è¸ªå’Œç®¡ç†, ä¹Ÿå¯ä»¥ä¸ºé•œåƒè®¾ç½®ä¸€ä¸ªæ ‡ç­¾, ä½¿ç”¨æ–¹æ³•ä¸º&quot;é•œåƒå:æ ‡ç­¾&quot;.</p><pre id="93ef2410-effc-4af7-b3a1-b708c9518dbe" class="code code-wrap"><code>Â [root@web02 static_web]# docker build -t=&quot;maxiaoyu/static_web&quot; .
Â Sending build context to Docker daemon 2.048 kB
Â Step 1/5 : FROM ubuntu:14.04
Â  ---&gt; 2c5e00d77a67
Â Step 2/5 : MAINTAINER maxiaoyu &quot;xiao_yu_ma@hotmail.com&quot;
Â  ---&gt; Using cache
Â  ---&gt; 136e266d732a
Â Step 3/5 : RUN apt-get update &amp;&amp; apt-get install -y nginx
Â  ---&gt; Running in 9fadc4f0a0b2
Â ......
Â Removing intermediate container 9fadc4f0a0b2
Â Step 4/5 : RUN echo &#x27;Hi, I am in your container&#x27;&gt;/usr/share/nginx/html/index.html
Â  ---&gt; Running in 2e6a1cebdc59
Â  ---&gt; e52811450d5e
Â Removing intermediate container 2e6a1cebdc59
Â Step 5/5 : EXPOSE 80
Â  ---&gt; Running in 64f64c521c2f
Â  ---&gt; 8fa670127b5d
Â Removing intermediate container 64f64c521c2f
Â Successfully built 8fa670127b5d</code></pre><p id="5c129d74-1e16-4f51-9757-4c04f2426d11" class="">å¯ä»¥æŒ‡å®šä¸€ä¸ªGitä»“åº“çš„æºåœ°å€æ¥æŒ‡å®šDockerfileçš„ä½ç½®, ä¸‹é¢çš„ç¤ºä¾‹æ˜¯ä»Gitä»“åº“æ„å»ºDockeré•œåƒ, è¿™é‡ŒDockerå‡è®¾åœ¨è¿™é‡ŒGitä»“åº“çš„æ ¹ç›®å½•ä¸‹å­˜åœ¨Dockerfileæ–‡ä»¶.</p><pre id="c7d9d86d-59c2-4b64-9f58-e6111f80fd04" class="code code-wrap"><code>Â docker build -t=&quot;maxiaoyu/static_web:v1&quot; git@github.com:jamtur01/docker-static_web</code></pre><p id="eb93ad60-f5ae-461a-8317-1ef73c4f5507" class="">å†å›åˆ°docker buildè¿‡ç¨‹. å¯ä»¥çœ‹åˆ°æ„å»ºä¸Šä¸‹æ–‡å·²ç»ä¸Šä¼ åˆ°äº†Dockerå®ˆæŠ¤è¿›ç¨‹, å¦‚ä¸Šé¢ä»£ç æ¸…å•æ‰€ç¤º.</p><pre id="3fa1513d-eb5a-40da-8a98-fccb4ecc9413" class="code code-wrap"><code>Â Sending build context to Docker daemon 2.048 kB</code></pre><p id="8cc4d2af-e38e-4e1e-b2a7-cc91fae8ac20" class="">ä¹‹å, å¯ä»¥çœ‹åˆ°Dockerfileä¸­çš„æ¯æ¡æŒ‡ä»¤ä¼šè¢«é¡ºåºæ‰§è¡Œ, è€Œä¸”ä½œä¸ºæ„å»ºç»“æœ,è¿”å›äº†æ–°é•œåƒID, å³<code>Successfully built 8fa670127b5d</code>. æ„å»ºçš„æ¯ä¸€æ­¥åŠå…¶å¯¹åº”æŒ‡ä»¤éƒ½ä¼šç‹¬ç«‹è¿è¡Œ, å¹¶ä¸”åœ¨è¾“å‡ºæœ€ç»ˆé•œåƒIDä¹‹å‰, Dockerä¼šæäº¤æ¯æ­¥çš„æ„å»ºç»“æœ.</p><blockquote id="769c7f34-ff54-48e6-800e-da5401fbe232" class="">å¦‚æœåœ¨ç›®å½•ä¸‹å­˜åœ¨.dockerignoreæ–‡ä»¶, é‚£ä¹ˆè¯¥æ–‡ä»¶çš„å†…å®¹ä¼šè¢«æŒ‰è¡Œè¿›è¡Œåˆ†éš”, æ¯è¡Œéƒ½æ˜¯ä¸€æ¡æ–‡ä»¶è¿‡æ»¤åŒ¹é…æ¨¡å¼. è¿™éå¸¸åƒ.gitigonoreæ–‡ä»¶. è¯¥æ–‡ä»¶ç”¨æ¥è®¾ç½®å“ªäº›æ–‡ä»¶ä¸ä¼šè¢«å½“ä½œæ„å»ºä¸Šä¸‹æ–‡çš„ä¸€éƒ¨åˆ†, å› æ­¤å¯ä»¥é˜²æ­¢å®ƒä»¬è¢«ä¸Šä¼ åˆ°Dockerå®ˆæŠ¤è¿›è¡Œä¸­å». è¯¥æ–‡ä»¶ä¸­æ¨¡å¼çš„åŒ¹é…è§„åˆ™é‡‡ç”¨Goè¯­è¨€ä¸­çš„filepath.</blockquote><p id="9199d88c-e3fe-4238-a44c-399870bb1798" class=""><strong>è¡¥å……: ä»€ä¹ˆæ˜¯æ„å»ºç¼“å­˜</strong></p><p id="22053a17-c84f-4b5e-83d3-b66104c23ee7" class="">æ¯ä¸€æ­¥çš„æ„å»ºè¿‡ç¨‹éƒ½ä¼šå°†ç»“æœæäº¤ä¸ºé•œåƒ, å®ƒä¼šå°†ä¹‹å‰çš„é•œåƒå±‚çœ‹ä½œç¼“å­˜.å®é™…ä¸Š, å½“ä¹‹å‰çš„æ„å»ºæ­¥éª¤æ²¡æœ‰å˜åŒ–æ—¶,å†æ¬¡æ„å»º,Dockerä¼šç›´æ¥ä»æœ€è¿‘ä¸€æ­¥çš„ç¼“å­˜å¼€å§‹. æ„å»ºç¼“å­˜èŠ‚çœäº†å¤§é‡æ—¶é—´. å¦‚æœçœŸçš„åœ¨ç¬¬ä¸€æ­¥åˆ°ç¬¬ä¸‰æ­¥ä¹‹é—´åšäº†ä»€ä¹ˆä¿®æ”¹, Dockeråˆ™ä¼šä»ç¬¬ä¸€æ¡å‘ç”Ÿäº†å˜åŒ–çš„æŒ‡ä»¤å¼€å§‹.</p><p id="4f699326-34de-4cab-893d-4e2f19909d53" class="">ç„¶è€Œ, æœ‰æ—¶å€™éœ€è¦ç¡®ä¿æ„å»ºè¿‡ç¨‹ä¸ä¼šä½¿ç”¨ç¼“å­˜. æ¯”å¦‚, å¦‚æœå·²ç»ç¼“å­˜äº†å‰é¢çš„ç¬¬ä¸‰æ­¥, å³<code>apt-get update</code>, é‚£ä¹ˆDockerå°†ä¸ä¼šå†æ¬¡åˆ·æ–°APTåŒ…çš„ç¼“å­˜. è¦æƒ³ç•¥è¿‡ç¼“å­˜åŠŸèƒ½, å¯ä»¥ä½¿ç”¨<code>docker build</code>çš„<code>--no-cache</code>æ ‡å¿—.</p><pre id="82c358f4-d654-4c2d-9b3a-05bb5b902ae6" class="code code-wrap"><code>Â docker build --no-cache -t=&quot;maxiaoyu/static_web&quot;
Â Sending build context to Docker daemon 2.048 kB
Â Step 1/5 : FROM ubuntu:14.04
Â  ---&gt; 2c5e00d77a67
Â Step 2/5 : MAINTAINER maxiaoyu &quot;xiao_yu_ma@hotmail.com&quot;
Â  ---&gt; Running in aa67e9261e7c
Â  ---&gt; cb6fe08b4e1b
Â Removing intermediate container aa67e9261e7c #åˆ é™¤ç¼“å­˜
Â Step 3/5 : RUN apt-get update &amp;&amp; apt-get install -y nginx
Â  ---&gt; Running in ae3fb09a98a0
Â </code></pre><p id="522f1718-f0dd-4a9d-aeef-8e9c61787b5f" class="">
</p><h3 id="d4fb9f11-ca04-4a84-af4f-116c51974c08" class="block-color-blue_background">æ­¥éª¤4: <strong>å…±äº«å’Œå‘å¸ƒé•œåƒ</strong></h3><p id="051be235-94f6-4ad1-a04d-a83cd9b3618a" class="">æ„å»ºé•œåƒä¸­å¾ˆé‡è¦çš„ä¸€ç¯å°±æ˜¯å¦‚ä½•å…±äº«å’Œå‘å¸ƒé•œåƒ. å¯ä»¥å°†é•œåƒæ¨é€åˆ°Docker HUbæˆ–è€…ç”¨æˆ·è‡ªå·±çš„ç§æœ‰Registeryä¸­. ä¸ºäº†å®Œæˆè¿™é¡¹å·¥ä½œ, éœ€è¦å…ˆåœ¨Docker Hubä¸Šåˆ›å»ºä¸€ä¸ªè´¦å·<a href="https://hub.docker.com/signup">https://hub.docker.com/signup</a>.</p><p id="b620a167-7cb4-4656-9e0b-46d359b24e7b" class="">æ³¨å†Œå®Œæ¯•åå°±å¯ä»¥æµ‹è¯•åˆšæ‰æ³¨å†Œçš„è´¦å·æ˜¯å¦èƒ½æ­£å¸¸ä½¿ç”¨å·¥ä½œäº†.</p><pre id="d36900f6-d65c-4cdd-8959-0f77d32f9cc4" class="code code-wrap"><code>Â [root@web02 ~]# docker login
Â Login with your Docker ID to push and pull images from Docker Hub. If you don&#x27;t have a Docker ID, head over to https://hub.docker.com to create one.
Â Username: maxiaoyula
Â Password: maxiaoyu!23
Â Login Succeeded</code></pre><p id="b23e8d57-2ceb-404d-b5c6-3709c51fd4a5" class="">è¿™æ¡å‘½ä»¤ä¼šå®Œæˆç™»é™†åˆ°Docker HUbçš„å·¥ä½œ, å¹¶å°†è®¤è¯ä¿¡æ¯ä¿å­˜èµ·æ¥ä¸€å…±åé¢ä½¿ç”¨. å¯ä»¥ä½¿ç”¨<code>docker logout</code>å‘½ä»¤ä»registeryæœåŠ¡å™¨é€€å‡º.</p><p id="030b3cfa-2e48-458d-b947-932dd55cf24a" class="">1.7.0ä¹‹å‰ä¸ªäººè®¤è¯ä¿¡æ¯ä¿å­˜åœ¨$HOME/.dockercfgæ–‡ä»¶ä¸­, 1.7.0å¼€å§‹, å˜ä¸º$HOME/.docker/config.json.</p><hr id="8ca6687d-78a3-47c2-9efd-1118ebbfd030"/><h1 id="de99ff99-9451-4f16-9f3b-2925cf53dba7" class="block-color-blue_background"><strong>DockerfileæŒ‡ä»¤</strong></h1><p id="07e369df-0712-4c84-ba27-3ca4d0b10f4a" class="">å¦‚<code>FROM</code>,<code>RUN</code>å’Œçš„å…¶ä»–æŒ‡ä»¤åŒ…æ‹¬<code>CMD</code>,<code>ENTRYPOINT</code>,<code>ADD</code>,<code>COPY</code>,<code>VOLUME</code>,<code>WORKDIR</code>,<code>USER</code>,<code>ONBUILD</code>,<code>LABEL</code> ,<code>STOPSIGNAL</code>,<code>ARG</code>,<code>ENV</code>,<code>EXPOSE</code>ç­‰.</p><p id="8cbfe542-3035-47c4-97c6-933e15ba1788" class="">åœ¨<a href="http://docs.docker.com/reference/builder/">http://docs.docker.com/reference/builder/</a>æŸ¥çœ‹æŒ‡ä»¤æ¸…å•.</p><p id="2636a2bf-9965-4d3f-8e8a-e505db6ecea9" class="">
</p><h2 id="19cb3d95-789b-4734-952c-bfe605da4baa" class="block-color-blue_background"><strong>CMD</strong></h2><p id="77f118d1-1a8e-4a8c-a264-f0263b965458" class=""><strong>CMDæŒ‡ä»¤ç”¨äºæŒ‡å®šä¸€ä¸ªå®¹å™¨å¯åŠ¨æ—¶è¦è¿è¡Œçš„å‘½ä»¤.</strong></p><p id="4100ae25-947c-4159-8784-6b5ebdea63e4" class=""><code>CMD</code>æ˜¯å‘Šè¯‰å®¹å™¨è¢«å¯åŠ¨æ—¶è¦è¿è¡Œçš„å‘½ä»¤. å’Œ<code>docker run</code>å‘½ä»¤å¯åŠ¨å®¹å™¨æ—¶æŒ‡å®šè¦è¿è¡Œçš„å‘½ä»¤éå¸¸ç±»ä¼¼. </p><pre id="07b9fbbb-6152-4733-9d6b-9fb46495d4f4" class="code code-wrap"><code>Â docker run -i -t maxiaoyu/static_web /bin/true</code></pre><p id="d5510e9f-ddb1-4765-822f-a4b50bd210df" class="">å¯ä»¥è®¤ä¸ºä¸Šé¢ä»£ç æ‰€ç¤ºçš„å‘½ä»¤å’Œåœ¨Dockerfileä¸­ä½¿ç”¨çš„CMDæŒ‡ä»¤æ˜¯ç­‰æ•ˆçš„. CMDæŒ‡ä»¤ç¤ºä¾‹å¦‚ä¸‹:</p><pre id="31107b64-a7a3-4f6b-a395-8507de820e82" class="code code-wrap"><code>Â CMD [&quot;/bin/true&quot;]</code></pre><p id="e718f690-65af-468e-9a93-184edb159ea4" class="">å½“ç„¶ä¹Ÿå¯ä»¥ä¸ºè¦è¿è¡Œçš„å‘½ä»¤æŒ‡å®šå‚æ•°, å°†<code>-l</code>é€‰é¡¹ä¼ é€’ç»™<code>/bin/bash</code>å‘½ä»¤.è¦è¿è¡Œçš„å‘½ä»¤æ˜¯å­˜æ”¾åœ¨ä¸€ä¸ªæ•°ç»„ç»“æ„ä¸­.  <strong>å®˜æ–¹æ¨èä½¿ç”¨ä»¥æ•°ç»„æ¥è®¾ç½®è¦æ‰§è¡Œçš„å‘½ä»¤</strong>.</p><pre id="dacd9dee-5cc3-4a42-b914-75e7ca3b53a6" class="code code-wrap"><code>Â CMD [&quot;/bin/sh&quot;,&quot;-c&quot;,&quot;ls -l&quot;]</code></pre><p id="7bc14ef2-4fd6-49d9-8a7f-76c250b5db66" class=""><strong>ä½¿ç”¨</strong><code><strong>docker run</strong></code><strong>å‘½ä»¤å¯ä»¥è¦†ç›–CMDæŒ‡ä»¤</strong>. å¦‚æœæˆ‘ä»¬åœ¨<code>Dockerfile</code>é‡ŒæŒ‡å®šäº†<code>CMD</code>æŒ‡ä»¤, è€ŒåŒæ—¶åœ¨<code>docker run</code>å‘½ä»¤è¡Œä¸­ä¹ŸæŒ‡å®šè¦è¿è¡Œçš„å‘½ä»¤,å‘½ä»¤è¡Œä¸­æŒ‡å®šçš„å‘½ä»¤ä¼šè¦†ç›–Docerfileä¸­çš„<code>CMD</code>æŒ‡ä»¤.</p><pre id="c9862230-df64-4532-95c0-2823bf3792d4" class="code code-wrap"><code>Â [root@web02 simple_sh]# docker run -it maxiaoyu/test /bin/ps
Â  Â  PID TTY Â  Â  Â  Â   TIME CMD
Â  Â  Â  1 ? Â  Â  Â   00:00:00 ps</code></pre><p id="39e2f09c-6a7e-413d-88c1-2b2969baa929" class=""><strong>åœ¨Dockerfileä¸­åªèƒ½æŒ‡å®šä¸€æ¡CMDæŒ‡ä»¤.</strong> å¦‚æŒ‡å®šå¤šæ¡CMDæŒ‡ä»¤, ä¹Ÿåªæœ‰æœ€åä¸€æ¡CMDæŒ‡ä»¤ä¼šè¢«ä½¿ç”¨. å¦‚æœå‘åœ¨å¯åŠ¨å®¹å™¨æ—¶è¿è¡Œå¤šä¸ªè¿›ç¨‹æˆ–è€…å¤šæ¡å‘½ä»¤, å¯ä»¥è€ƒè™‘ä½¿ç”¨ç±»å‹Supervisorè¿™æ ·çš„æœåŠ¡å™¨ç®¡ç†å·¥å…·.</p><h2 id="2a0abef7-f761-4b26-94ce-ae7ffae3b46d" class="block-color-blue_background"><strong>ENTRYPOINT</strong></h2><p id="5f5189f0-fcbe-419f-96b1-7370f59cd70a" class="">å’Œ<code>CMD</code>æŒ‡ä»¤éå¸¸ç›¸ä¼¼, åŒºåˆ«æ˜¯ä»€ä¹ˆå‘¢? <code>docker run</code>å‘½ä»¤å¯ä»¥è¦†ç›–<code>CMD</code>æŒ‡ä»¤. è€Œæœ‰æ—¶æˆ‘ä»¬å¸Œæœ›å®¹å™¨å°†æŒ‰ç…§æˆ‘ä»¬æœŸæœ›çš„é‚£æ ·å»å·¥ä½œ, è¿™æ—¶å€™<code>CMD</code>å°±ä¸å¤ªé€‚åˆäº†. è€Œ<code>ENTRYPOINT</code>æŒ‡ä»¤æä¾›çš„å‘½ä»¤åˆ™åœ¨å¯åŠ¨å®¹å™¨æ—¶ä¸è¢«è¦†ç›–. <strong>å®é™…ä¸Š, </strong><code><strong>docker run</strong></code><strong>å‘½ä»¤è¡Œä¸­æŒ‡å®šçš„ä»»ä½•å‘½ä»¤éƒ½ä¼šè¢«å½“ä½œå‚æ•°å†æ¬¡ä¼ é€’ç»™</strong><code><strong>ENTRYPOINT</strong></code><strong>æŒ‡ä»¤ä¸­çš„å‘½ä»¤.</strong></p><p id="8bd85995-9f78-4036-911b-a7c4bebaef5a" class="">æŒ‡å®š<code>ENTRYPOINT</code>æŒ‡ä»¤</p><pre id="09d7d06d-bf0d-4874-9db8-0a0fe91c9ec9" class="code code-wrap"><code>Â FROM ubuntu:14.04
Â MAINTAINER maxiaoyu &quot;xiao_yu_ma@hotmail.com&quot;
Â RUN apt-get update &amp;&amp; apt-get install -y nginx
Â RUN echo &#x27;Hi, I am in your container&#x27; \
Â  Â   &gt;/usr/share/nginx/html/index.html
Â ENTRYPOINT [&quot;/bin/sh&quot;,&quot;-c&quot;,&quot;/usr/sbin/nginx&quot;]
Â EXPOSE 80</code></pre><p id="2e80486b-b030-4064-9cb3-f9e5438dc5d0" class="">ç°åœ¨å°†<code>ENTRYPOINT</code>è®¾ç½®ä¸º<code>ENTRYPOINT</code>[&quot;/usr/sbin/nginx&quot;], é‡æ–°æ„å»ºé•œåƒ, ç„¶å, <code>maxiaoyu/static_web</code>é•œåƒå¯åŠ¨ä¸€ä¸ªæ–°å®¹å™¨.æŒ‡å®šäº†<code>-g &quot;daemon off;&quot;</code>å‚æ•°, è¿™ä¸ªå‚æ•°ä¼šä¼ é€’ç»™ENTRPOINTæŒ‡å®šä¸­çš„å‘½ä»¤, åœ¨è¿™é‡Œè¯¥å‘½ä»¤ä¸º<code>/usr/sbin/nginx -g &quot;daemon off&quot;;</code>.</p><p id="269f21e8-fc6d-4d7b-86b2-0faa15ff5b22" class=""><strong>ä½¿ç”¨</strong><code><strong>ENTRYPOINT</strong></code><strong>å¯ä»¥æ­é…</strong><code><strong>CMD</strong></code><strong>æŒ‡ä»¤.</strong></p><pre id="b580251f-9d76-4a37-b431-6b2562d40418" class="code code-wrap"><code>Â FROM ubuntu:14.04
Â MAINTAINER maxiaoyu &quot;xiao_yu_ma@hotmail.com&quot;
Â RUN apt-get update &amp;&amp; apt-get install -y nginx
Â RUN echo &#x27;Hi, I am in your container&#x27; \
Â  Â   &gt;/usr/share/nginx/html/index.html
Â ENTRYPOINT [&quot;/usr/sbin/nginx&quot;]
Â CMD [&quot;-h&quot;]
Â EXPOSE 80</code></pre><p id="a723d23e-ef37-40e2-90ac-9bc455ecbd48" class="">æ­¤æ—¶å½“æˆ‘ä»¬<strong>å¯åŠ¨ä¸€ä¸ªå®¹å™¨</strong>æ—¶, ä»»ä½•åœ¨å‘½ä»¤è¡Œä¸­æŒ‡å®šçš„å‚æ•°éƒ½ä¼šè¢«ä¼ é€’ç»™Nginxå®ˆæŠ¤è¿›ç¨‹. æ¯”å¦‚, æˆ‘ä»¬å¯ä»¥æŒ‡å®š<code>-g &quot;daemon off&quot;;</code>å‚æ•°è®©Nginxå®ˆæŠ¤è¿›ç¨‹ä»¥å‰å°æ–¹å¼è¿è¡Œ,ç»“æœå¦‚ä¸‹:</p><figure id="282bce67-f8d2-4e12-be9c-972febe164fc" class="image"><a href="Dockerfile%20cf1d6/1575508438144.png"><img style="width:748px" src="Dockerfile%20cf1d6/1575508438144.png"/></a></figure><p id="e2361d4c-50cb-49e2-af3e-8b31c6d271a4" class="">å¦‚æœåœ¨å¯åŠ¨å®¹å™¨æ—¶ä¸æŒ‡å®šä»»ä½•å‚æ•°, åˆ™åœ¨CMDæŒ‡ä»¤ä¸­æŒ‡å®š -hå‚æ•°ä¼šè¢«ä¼ é€’ç»™Nginxå®ˆæŠ¤è¿›ç¨‹, å³NginxæœåŠ¡å™¨ä»¥<code>/usr/sbin/nginx -h</code>çš„æ–¹å¼å¯åŠ¨, æ”¹åäº†ç”¨æ¥æ˜¾ç¤ºNginxçš„å¸®åŠ©ä¿¡æ¯, ç»“æœå¦‚ä¸‹:</p><figure id="0d94b9f7-ce29-4c7a-b202-6b67c8252322" class="image"><a href="Dockerfile%20cf1d6/1575508401541.png"><img style="width:701px" src="Dockerfile%20cf1d6/1575508401541.png"/></a></figure><p id="08943eb3-d8fb-410a-b641-a7a4e508e408" class="">å¦‚æ­¤<strong>æˆ‘ä»¬å¯ä»¥æ„å»ºè¿™æ ·ä¸€ä¸ªé•œåƒ, è¯¥é•œåƒæ—¢å¯ä»¥è¿è¡Œä¸€ä¸ªé»˜è®¤çš„å‘½ä»¤, åŒæ—¶å®ƒä¹Ÿæ”¯æŒé€šè¿‡</strong><code><strong>docker run</strong></code><strong>å‘½ä»¤è¡Œä¸ºè¯¥æŒ‡ä»¤æŒ‡å®šå¯è¦†ç›–çš„é€‰é¡¹æˆ–è€…æ ‡å¿—.</strong></p><blockquote id="43cdca9f-f8d8-4560-927b-511a85acf5b4" class="">æç¤ºå¦‚æœç¡®å®éœ€è¦, ç”¨æˆ·ä¹Ÿå¯ä»¥åœ¨è¿è¡Œæ—¶é€šè¿‡docker runçš„--entrypointé€‰é¡¹è¦†ç›–ENTRYPOINTæŒ‡ä»¤.</blockquote><hr id="5dbe0b0d-a564-48a5-a9f4-cb3898dc35bf"/><h2 id="e4263c4b-91e7-4bae-b483-30ab5a139d28" class="block-color-blue_background"><strong>WORKDIR</strong></h2><p id="852c26c5-4867-4fad-a6db-484a962cf40b" class=""><code>WORKDIR</code>æŒ‡ä»¤ç”¨æ¥åœ¨ä»é•œåƒåˆ›å»ºä¸€ä¸ªæ–°å®¹å™¨æ—¶, åœ¨å®¹å™¨å†…éƒ¨è®¾ç½®ä¸€ä¸ªå·¥ä½œç›®å½•, ENTRYPOINTå’Œ/æˆ–CMDæŒ‡å®šçš„ç¨‹åºä¼šåœ¨è¿™ä¸ªç›®å½•ä¸‹æ‰§è¡Œ.</p><p id="9bd56dd2-9606-425b-ba8d-d8bc7d0083d6" class="">æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¯¥æŒ‡ä»¤<strong>ä¸ºDockerfileä¸­åç»­çš„ä¸€ç³»åˆ—æŒ‡ä»¤è®¾ç½®å·¥ä½œç›®å½•, ä¹Ÿå¯ä»¥ä¸ºæœ€ç»ˆçš„å®¹å™¨è®¾ç½®å·¥ä½œç›®å½•</strong>. æ¯”å¦‚, æˆ‘ä»¬å¯ä»¥ä¸ºç‰¹å®šçš„æŒ‡ä»¤è®¾ç½®ä¸åŒçš„å·¥ä½œç›®å½•.</p><pre id="b28296b1-b111-4757-bbfd-d260f6ee447a" class="code code-wrap"><code>Â WORKDIR /opt/webapp/db
Â RUN bundle install
Â WORKDIR /opt/webapp
Â ENTRYPOINT [&quot;rackup&quot;]</code></pre><p id="39116842-e227-42fa-951c-1cafd98f2668" class="">è¿™é‡Œ, æˆ‘ä»¬<strong>å°†å·¥ä½œç›®å½•åˆ‡æ¢</strong>ä¸º<code>/opt/webapp/db</code>åè¿è¡Œäº†<code>bundle install</code>å‘½ä»¤, ä¹‹ååˆå°†å·¥ä½œç›®å½•è®¾ç½®ä¸º<code>/opt/webapp</code>, æœ€åè®¾ç½®<code>ENTRYPOINT</code>æŒ‡ä»¤æ¥å¯åŠ¨rackupå‘½ä»¤.</p><p id="91543732-9ac3-4d9b-a485-da085286510e" class="">å¯ä»¥é€šè¿‡<code>-w</code>é€‰é¡¹åœ¨è¿è¡Œæ—¶è¦†ç›–å·¥ä½œç›®å½•, å¦‚ä¸‹æ‰€ç¤º:</p><pre id="a9d4b22a-5ac3-4b43-b65f-f2f51f08b16d" class="code code-wrap"><code>Â docker run -ti -w /var/log ubuntu pwd
Â /var/log</code></pre><p id="9670758e-21d7-4d9c-8891-bdb49ce926d9" class="">è¯¥å‘½ä»¤ä¼šå°†å®¹å™¨å†…çš„å·¥ä½œç›®å½•è®¾ç½®ä¸º/var/log</p><hr id="c8551bf2-46a8-4703-ba01-9dfd32f79ca5"/><h2 id="9a15db89-4427-4118-b2e0-dd1ffcbaad32" class=""><strong>ENV</strong></h2><p id="e8d1e267-9acd-4077-80a7-dd7cdd33f1c7" class=""><strong>ENVæŒ‡ä»¤ç”¨æ¥åœ¨é•œåƒæ„å»ºè¿‡ç¨‹ä¸­è®¾ç½®ç¯å¢ƒå˜é‡.</strong></p><pre id="be7bd9b0-f9ad-4ee7-8f98-fe398bf28edd" class="code code-wrap"><code>Â ENV RVM_PATH /home/rvm/</code></pre><p id="d553804a-eda9-4e34-af50-080e1e33444a" class="">è¿™ä¸ªæ–°çš„ç¯å¢ƒå˜é‡å¯ä»¥åœ¨åç»­çš„ä»»ä½•RUNæŒ‡ä»¤ä¸­ä½¿ç”¨, è¿™å°±å¦‚åŒåœ¨å‘½ä»¤å‰é¢æŒ‡å®šäº†ç¯å¢ƒå˜é‡å‰ç¼€ä¸€ä¸‹, å¦‚ä¸‹æ‰€ç¤º:</p><pre id="33a62d2d-178a-4cae-9ddb-1fb885a10f60" class="code code-wrap"><code>Â RUN gem install unicorn</code></pre><p id="cbb84f96-582f-4824-81b2-a168ee12f364" class="">è¯¥æŒ‡ä»¤ä¼šä»¥å¦‚ä¸‹æ‰€ç¤ºçš„æ–¹å¼æ‰§è¡Œ</p><pre id="e7de3998-8a8c-4883-80da-8c0ad9fb1cec" class="code code-wrap"><code>Â RVM_PATH=/home/rvm/  gem install unicorn</code></pre><p id="36713d2c-3d95-42c7-844f-2449ac71cb28" class="">å¯ä»¥åœ¨ENVæŒ‡ä»¤ä¸­æŒ‡å®šå•ä¸ªç¯å¢ƒå˜é‡, æˆ–è€…, ä»Docker1.4å¼€å§‹å¯ä»¥å‘ä¸‹é¢æ‰€ç¤ºé‚£æ ·æŒ‡å®šå¤šä¸ªå˜é‡.</p><pre id="5c0fb606-8d39-4721-bfe5-b4df837f6945" class="code code-wrap"><code>Â ENV RVM_PATH=/home/rvm RVM_ARCHFLAGS=&quot;-arch i386&quot;</code></pre><p id="67611622-1900-4c8d-b679-94d21087fa3a" class="">ä¹Ÿå¯ä»¥åœ¨å…¶ä»–æŒ‡ä»¤ä¸­ä½¿ç”¨è¿™äº›ç¯å¢ƒå˜é‡, å¦‚ä¸‹æ‰€ç¤º:</p><pre id="1d03d110-6f74-4270-a16f-18a54d391e9f" class="code code-wrap"><code>Â ENV TARGET_DIR /etc
Â WORKDIR $TARGET_DIR
Â CMD [&quot;pwd&quot;]</code></pre><p id="fe599af7-947f-4047-a311-0a6acf246fa8" class="">åœ¨è¿™é‡Œæˆ‘ä»¬è®¾å®šäº†ä¸€ä¸ªæ–°çš„ç¯å¢ƒå˜é‡<code>TARGET_DIR</code>,å¹¶åœ¨<code>WORKDIR</code>ä¸­ä½¿ç”¨äº†å®ƒçš„å€¼.å› æ­¤å®é™…ä¸Š<code>workdir</code>æŒ‡ä»¤çš„å€¼ä¼šè¢«è®¾ä¸º<code>/etc</code>.</p><pre id="fde56b02-2518-48eb-984b-ef912e7e9f31" class="code code-wrap"><code>Â [root@web02 simple_sh]# docker run -i -t maxiaoyu/test
Â /etc</code></pre><blockquote id="259ce08f-11bf-4c47-857c-42bde90da5aa" class="">æ³¨æ„å¦‚æœéœ€è¦, å¯ä»¥é€šè¿‡åœ¨ç¯å¢ƒå˜é‡å‰åŠ ä¸Šä¸€ä¸ªåæ–œçº¿è¿›è¡Œè½¬ä¹‰.</blockquote><p id="7e63a17b-742d-4b7e-b359-e3a6751a9926" class="">è¿™äº›ç¯å¢ƒå˜é‡ä¹Ÿä¼šè¢«æŒä¹…ä¿å­˜åˆ°ä»æˆ‘ä»¬çš„é•œåƒåˆ›å»ºçš„ä»»ä½•å®¹å™¨ä¸­. æ‰€ä»¥, å¦‚æœæˆ‘ä»¬åœ¨ä½¿ç”¨<code>ENV RVM_PATH/home/rvm/</code>æŒ‡ä»¤æ„å»ºçš„å®¹å™¨ä¸­è¿è¡Œ<code>env</code>å‘½ä»¤, å°†ä¼šçœ‹åˆ°ä¸‹é¢çš„ç»“æœ</p><figure id="d78da91c-239c-4a12-acac-7877dbdd35bd" class="image"><a href="Dockerfile%20cf1d6/1575511325619.png"><img style="width:571px" src="Dockerfile%20cf1d6/1575511325619.png"/></a></figure><p id="7d2fb130-ef94-45d4-9415-46ff52f0ef4f" class="">ä¹Ÿå¯ä»¥ä½¿ç”¨<code>docker run</code>å‘½ä»¤è¡Œçš„<code>-e</code>æ ‡å¿—æ¥ä¼ é€’ç¯å¢ƒå˜é‡.  ä»ä¸‹é¢çš„ç¤ºä¾‹, å¯ä»¥çœ‹åˆ°, åœ¨å®¹å™¨ä¸­<code>WEB_PORT</code>ç¯å¢ƒå˜é‡è¢«è®¾ä¸ºäº†8080.</p><figure id="5e56a890-4573-4526-a892-e804137d84b8" class="image"><a href="Dockerfile%20cf1d6/1575511709874.png"><img style="width:812px" src="Dockerfile%20cf1d6/1575511709874.png"/></a></figure><hr id="13c874e5-85fc-4c66-8398-5107284db1a2"/><h2 id="5afaefe8-74ff-42bc-80e2-5e824b40e4f4" class=""><strong>USER</strong></h2><p id="95807353-bcf8-4f45-a093-b174ae1e2750" class=""><code>USER</code>æŒ‡ä»¤ç”¨æ¥æŒ‡å®šè¯¥é•œåƒä¼šä»¥ä»€ä¹ˆæ ·çš„ç”¨æˆ·å»è¿è¡Œ, å¦‚ä¸‹æ‰€ç¤º:</p><pre id="45591df2-cec6-4ce1-a89a-6e947e2a142e" class="code code-wrap"><code>Â USER nginx</code></pre><p id="d6a08164-2cea-4cc4-9377-17e25628dc1a" class="">åŸºäºè¯¥é•œåƒå¯åŠ¨çš„å®¹å™¨ä¼šä»¥nginxç”¨æˆ·çš„èº«ä»½æ¥è¿è¡Œ, æˆ‘ä»¬å¯ä»¥æŒ‡å®šç”¨æˆ·åæˆ–UIDä»¥åŠç»„æˆ–GID, ç”šè‡³ä¸¤è€…çš„ç»“åˆ, å¦‚ä¸‹æ‰€ç¤º, æŒ‡å®šUSERå’ŒGROUPçš„å„ç§ç»„åˆ</p><pre id="b1f4e497-c94b-4e5d-9024-37035dd87199" class="code code-wrap"><code>Â USER user
Â USER user:group
Â USER uid
Â USER uid:gid
Â USER user:gid
Â USER uid:group</code></pre><p id="37643516-8eb9-4c6d-bec5-e3dace2dea0e" class="">ä¹Ÿå¯ä»¥åœ¨<code>docker run</code>å‘½ä»¤ä¸­é€šè¿‡<code>-u</code>é€‰é¡¹è¦†ç›–è¯¥æŒ‡ä»¤æŒ‡å®šçš„å€¼.</p><p id="a2fd444e-990a-4308-a0f8-b70dcf8f0b4e" class="">é€šè¿‡ä¸‹é¢ç¤ºä¾‹, æ¼”ç¤ºUSERæŒ‡ä»¤çš„ç”¨æ³•</p><pre id="182cdadc-37e1-4073-bd2c-e1a6b47bd5d7" class="code code-wrap"><code>Â #ä¿®æ”¹Dockerfile
Â [root@web02 simple_sh]# vim Dockerfile
Â FROM ubuntu:14.04
Â MAINTAINER Ma Xiaoyu &quot;xiao_yu_ma@hotmail.com&quot;
Â ENV REFRESHED_AT 20191204
Â RUN [&quot;useradd&quot;, &quot;nginx&quot;] #åˆ›å»ºç”¨æˆ·
Â USER nginx Â  #é€šè¿‡USERæŒ‡ä»¤, åˆ‡æ¢åˆ°nginxç”¨æˆ·èº«ä»½
Â CMD [&quot;whoami&quot;] #æŸ¥çœ‹å½“å‰ç”¨æˆ·èº«ä»½
Â 
Â #æ„å»º
Â [root@web02 simple_sh]# docker build -t=&quot;maxiaoyu/test&quot; .
Â 
Â #è¿è¡Œå®¹å™¨
Â [root@web02 simple_sh]# docker run -t -i maxiaoyu/test
Â nginx</code></pre><hr id="0d4f34de-bf5e-4252-b423-c8537630ea99"/><h2 id="6343c887-1e0a-4e30-a123-b4711505074c" class=""><strong>VOLUME</strong></h2><p id="8621b5f2-e589-4d01-a51c-72c7cbd9ee1e" class="">VOLUMEä¸ºåŸºäºæ­¤é•œåƒåˆ›å»ºçš„ä»»ä½•å®¹å™¨åˆ›å»ºå·.  <strong>ä¸€ä¸ªå·æ˜¯å¯ä»¥å­˜åœ¨äºä¸€ä¸ªæˆ–è€…å¤šä¸ªå®¹å™¨å†…çš„ç‰¹å®šçš„ç›®å½•</strong>, è¿™ä¸ªç›®å½•å¯ä»¥<strong>ç»•è¿‡è”åˆæ–‡ä»¶ç³»ç»Ÿ</strong>, å¹¶æä¾›å¦‚ä¸‹å…±äº«æ•°æ®æˆ–è€…å¯¹æ•°æ®è¿›è¡ŒæŒä¹…åŒ–çš„åŠŸèƒ½.</p><ul id="1b0394b2-a295-41ca-b095-1c15f26506ff" class="bulleted-list"><li style="list-style-type:disc">å·å¯ä»¥åœ¨å®¹å™¨é—´å…±äº«å’Œé‡ç”¨.</li></ul><ul id="ff5a39f3-73d7-4b9c-8a57-7ea6ab0dc8f8" class="bulleted-list"><li style="list-style-type:disc">ä¸€ä¸ªå®¹å™¨å¹¶ä¸æ˜¯ä¸€å®šè¦å’Œå…¶ä»–å…¶ä»–å®¹å™¨<strong>å…±äº«</strong>å·.</li></ul><ul id="81d045a3-78df-489d-9a84-6d763a1ccba6" class="bulleted-list"><li style="list-style-type:disc">å¯¹å·çš„ä¿®æ”¹æ˜¯ç«‹æ—¶ç”Ÿæ•ˆçš„.</li></ul><ul id="8f1c4094-172e-4cd1-8b76-8bb46663b358" class="bulleted-list"><li style="list-style-type:disc">å¯¹å·çš„ä¿®æ”¹ä¸ä¼šå¯¹æ›´æ–°é•œåƒäº§ç”Ÿå½±å“.</li></ul><ul id="a32e2c42-8530-4280-a491-00f526dce6ed" class="bulleted-list"><li style="list-style-type:disc">å·ä¼šä¸€ç›´å­˜åœ¨ç›´åˆ°æ²¡æœ‰ä»»ä½•å®¹å™¨å†ä½¿ç”¨å®ƒ.</li></ul><p id="cd5ebde7-8b10-4af4-9966-43fe162b25b5" class="">å·åŠŸèƒ½è®©æˆ‘ä»¬å¯ä»¥<strong>å°†æ•°æ®(å¦‚æºä»£ç ), æ•°æ®åº“æˆ–è€…å…¶ä»–å†…å®¹æ·»åŠ åˆ°é•œåƒä¸­è€Œä¸æ˜¯å°†è¿™äº›å†…å®¹æäº¤åˆ°é•œåƒä¸­</strong>, å¹¶ä¸”å…è®¸æˆ‘ä»¬å†å¤šä¸ªå®¹å™¨é—´å…±äº«è¿™äº›å†…å®¹. æˆ‘ä»¬å¯ä»¥åˆ©ç”¨æ­¤åŠŸèƒ½æ¥æµ‹è¯•å®¹å™¨å’Œå†…éƒ¨çš„åº”ç”¨ç¨‹åºä»£ç , ç®¡ç†æ—¥å¿—, æˆ–è€…å¤„ç†å®¹å™¨å†…éƒ¨çš„æ•°æ®åº“.</p><pre id="d7014a4d-d8c1-4edc-aabf-89ff4b96a04e" class="code code-wrap"><code>#ä¸ºå®¹å™¨åˆ›å»ºä¸€ä¸ªåä¸º/opt/projectçš„æŒ‚è½½ç‚¹.
VOLUME [&quot;/opt/project&quot;]

#ä¹Ÿå¯ä»¥é€šè¿‡æŒ‡å®šæ•°ç»„çš„æ–¹å¼æŒ‡å®šå¤šä¸ªå·, å¦‚ä¸‹æ‰€ç¤º:
VOLUME [&quot;/opt/project&quot;, &quot;/data&quot;]</code></pre><p id="e58dac46-b878-4d99-a24f-a342f3b42963" class="">
</p><blockquote id="d074e449-4bda-467a-a81d-bb5bbf15ee81" class="">å¦‚æœç°åœ¨å¯¹å·åŠŸèƒ½å¾ˆå¥½å¥‡, ä¹Ÿå¯ä»¥åœ¨http://docs.docker.com/userguide/dockervolumes/è¯»åˆ°æ›´å¤šå…³äºå·çš„ä¿¡æ¯.</blockquote><hr id="c3c0eaa9-bc81-44e7-abec-9aac86af33ab"/><h2 id="dcfe53a7-3773-43f7-949f-49993b023dcd" class=""><strong>ADD</strong></h2><p id="46f49c59-e759-43ec-93b7-50336f4b7fba" class=""><strong>ADDæŒ‡ä»¤ç”¨æ¥å°†æ„å»ºç¯å¢ƒä¸‹çš„æ–‡ä»¶å’Œç›®å½•å¤åˆ¶åˆ°é•œåƒä¸­, æ³¨æ„, ä¸èƒ½å¯¹æ„å»ºç›®å½•ä¹‹å¤–çš„æ–‡ä»¶è¿›è¡ŒADDæ“ä½œ.</strong></p><p id="19ff597c-6747-4385-9903-e3f741a66e18" class=""><strong>æºæ–‡ä»¶å‚æ•°å¯ä»¥æ˜¯ä¸€ä¸ªURL, æˆ–è€…æ–‡ä»¶åæˆ–ç›®å½•,ç›®çš„åœ°å€å‚æ•°ä»¥/ç»“å°¾æ˜¯ç›®å½•ä¸æ˜¯ä»¥/ç»“å°¾æ˜¯æ–‡ä»¶.</strong></p><p id="a02d65d7-5aa8-4489-8f08-ff0320460c94" class=""><strong>å¯ä»¥è‡ªåŠ¨è§£å‹å½’æ¡£æ–‡ä»¶.</strong></p><p id="c2ca4842-009c-4808-8217-2e227241f752" class=""><strong>ç›®çš„ä½ç½®ä¸å­˜åœ¨,ä¼šåˆ›å»ºå…¨è·¯å¾„,UID/GIDæ˜¯0,æƒé™æ˜¯755</strong></p><p id="16d8e223-10e3-4571-aa31-2e1998f97da9" class=""><strong>ä½¿Dockerfileä¸­çš„åç»­æŒ‡ä»¤éƒ½ä¸èƒ½ç»§ç»­ä½¿ç”¨ä¹‹å‰çš„æ„å»ºç¼“å­˜</strong></p><p id="eb3ee879-8dd5-4d2b-8ed7-79c2cc786ed9" class="">æ¯”å¦‚, åœ¨å®‰è£…ä¸€ä¸ªåº”ç”¨ç¨‹åºæ—¶. ADDæŒ‡ä»¤éœ€è¦æºæ–‡ä»¶å’Œç›®çš„æ–‡ä»¶ä¸¤ä¸ªå‚æ•°,å¦‚ä¸‹æ‰€ç¤º, ADDæŒ‡ä»¤å°†software.licæ–‡ä»¶å¤åˆ¶åˆ°é•œåƒä¸­çš„<code>/opt/application/</code>ç›®å½•ä¸‹.</p><pre id="69ab3126-ef7f-495c-8f77-328e5a7631a8" class="code code-wrap"><code>Â ADD software.lic /opt/application/software.lic</code></pre><p id="b7ddc69b-1ca0-4e57-ba7a-a2b08a5b79bd" class="">åœ¨ADDæ—¶, é€šè¿‡ç›®çš„åœ°å€å‚æ•°æœ«å°¾çš„å­—ç¬¦æ¥åˆ¤æ–­æ–‡ä»¶æºæ˜¯ç›®å½•è¿˜æ˜¯æ–‡ä»¶.ä»¥/ç»“å°¾æ˜¯ç›®å½•,ä¸æ˜¯ä»¥/ç»“å°¾æ˜¯æ–‡ä»¶.</p><p id="6beb61b8-aac1-4e7d-9d01-dec3f5d0c276" class="">æ–‡ä»¶æºä¹Ÿå¯ä»¥ä½¿ç”¨URLçš„æ ¼å¼</p><pre id="1beb0b00-653a-40a6-b266-cf5c10729ee6" class="code code-wrap"><code>Â ADD http://wordpress.org/lastest.zip /root/wordpress.zip</code></pre><p id="3687ddaf-9d6a-4eee-a593-f286502c92f5" class="">å¦‚æœå°†ä¸€ä¸ªå½’æ¡£æ–‡ä»¶(åˆæ³•çš„è§„èŒƒå½“æ–‡ä»¶åŒ…æ‹¬ gzip, bzip2, xz)æŒ‡å®šä¸ºæºæ–‡ä»¶, Dockerä¼šè‡ªåŠ¨å°†æ–‡æ¡£æ–‡ä»¶è§£å¼€(unpack). å¦‚ä¸‹,æ¡å‘½ä»¤ä¼šå°†å½’æ¡£æ–‡ä»¶<code>lastest.tar.gz</code>æ­å¼€åˆ°<code>/var/www/wordpress/</code>ç›®å½•ä¸‹,è¡Œä¸ºå’Œä½¿ç”¨<code>-x</code>é€‰é¡¹çš„<code>tar</code>å‘½ä»¤ä¸€æ ·.</p><pre id="0cf4c291-69b9-45d1-be0f-ef7a8389cf3b" class="code code-wrap"><code>Â ADD lastest.tar.gz /var/www/wordpress/</code></pre><p id="9ac984ab-e93a-4c43-8b35-d5e678a9579c" class="">Dockerè§£å¼€å½’æ¡£æ–‡ä»¶çš„: è¯¥æŒ‡ä»¤æ‰§è¡Œåçš„è¾“å‡ºæ˜¯åŸç›®çš„ç›®å½•å·²ç»å­˜åœ¨çš„å†…å®¹åŠ ä¸Šå½’æ¡£æ–‡ä»¶ä¸­çš„å†…å®¹. å¦‚æœç›®çš„ä½ç½®çš„ç›®å½•ä¸‹å·²ç»å­˜åœ¨äº†å’Œå½’æ¡£æ–‡ä»¶åŒåçš„æ–‡ä»¶æˆ–è€…ç›®å½•, é‚£ä¹ˆç›®çš„ä½ç½®ä¸­çš„æ–‡ä»¶æˆ–è€…ç›®å½•ä¸ä¼šè¢«è¦†ç›–.</p><p id="81b71a1d-0e6f-402f-a90e-b170b24b1b2a" class="">æœ€å, å¦‚æœç›®çš„ä½ç½®ä¸å­˜åœ¨çš„è¯, Dockerå°†ä¼šä¸ºæˆ‘ä»¬åˆ›å»ºè¿™ä¸ªå…¨è·¯å¾„, åŒ…æ‹¬è·¯å¾„ä¸­çš„ä»»ä½•ç›®å½•. æ–°åˆ›å»ºçš„æ–‡ä»¶å’Œç›®å½•çš„æ¨¡å¼ä¸º0755, å¹¶ä¸”UIDå’ŒGIDéƒ½æ˜¯0.</p><p id="0d6ca0a9-9fd1-406c-8cdb-0770627f4f49" class="">ADDæŒ‡ä»¤å°†ä¼šä½¿&quot;æ„å»ºç¼“å­˜&quot;å˜å¾—æ— æ•ˆ, è¿™ä¸€ç‚¹éå¸¸é‡è¦. å¦‚æœä½¿ç”¨ADDæŒ‡ä»¤å‘é•œåƒæ·»åŠ ä¸€ä¸ªæ–‡ä»¶æˆ–è€…ç›®å½•, é‚£ä¹ˆè¿™å°†ä½¿Dockerfileä¸­çš„åç»­æŒ‡ä»¤éƒ½ä¸èƒ½ç»§ç»­ä½¿ç”¨ä¹‹å‰çš„æ„å»ºç¼“å­˜.</p><hr id="e8d4d080-1fa3-4e43-a6d2-4ab2f3bd4869"/><h2 id="aeae5f64-03dd-44e5-8f6d-84751635a513" class="block-color-blue_background"><strong>COPY</strong></h2><p id="d183c8bc-8135-48c1-a642-abcdd4b18749" class=""><strong>ç±»ä¼¼ADD,ä½†ä¸åšæ–‡ä»¶æå–å’Œè§£å‹çš„å·¥ä½œ.</strong><strong>å¯å¤åˆ¶ç›®å½•æˆ–æ–‡ä»¶,åŒ…æ‹¬å…ƒæ•°æ®</strong></p><p id="5da07463-b374-4217-b9b5-2b0bd76c0c9a" class=""><strong>ç›®çš„ä½ç½®ä¸å­˜åœ¨,ä¼šåˆ›å»ºå…¨è·¯å¾„,UID/GIDæ˜¯0</strong></p><p id="abe5a993-1b8a-4061-83ae-29288244a7a2" class=""><strong>ä¸èƒ½å¤åˆ¶åˆ°è¯¥æ„å»ºç›®å½•ä¹‹å¤–çš„ä»»ä½•æ–‡ä»¶</strong></p><p id="635110ed-4d92-4f0e-845d-af1a0bd62979" class=""><strong>COPYæŒ‡ä»¤çš„ç›®çš„ä½ç½®åˆ™å¿…é¡»æ˜¯å®¹å™¨å†…éƒ¨çš„ä¸€ä¸ªç»å¯¹è·¯å¾„.</strong></p><p id="2e787e70-2dab-48b0-8bf0-c3fd98e3cbca" class="">ä½¿ç”¨å¦‚ä¸‹,è¿™æ¡æŒ‡ä»¤å°†ä¼šæŠŠæœ¬åœ°<code>conf.d/</code>ç›®å½•ä¸­çš„æ–‡ä»¶å¤åˆ¶åˆ°<code>/etc/apache2/</code>ç›®å½•ä¸­.</p><pre id="9429e5f0-44ce-4d5a-a7dc-2a834c1f4945" class="code code-wrap"><code>Â COPY conf.d/ /etc/apache2/</code></pre><p id="8b343c08-03dd-4277-933c-eca436e65064" class="">ä¸èƒ½å¤åˆ¶åˆ°è¯¥ç›®å½•ä¹‹å¤–çš„ä»»ä½•æ–‡ä»¶,å› ä¸ºæ„å»ºç¯å¢ƒå°†ä¼šä¸Šä¼ åˆ°Dockerå®ˆæŠ¤è¿›ç¨‹, è€Œå¤åˆ¶æ˜¯åœ¨Dockerè¿›ç¨‹è¿›ç¨‹ä¸­çš„åŠé€†è¡Œçš„. ä»»ä½•ä½äºæ„å»ºç¯å¢ƒä¹‹å¤–çš„ä¸œè¥¿éƒ½æ˜¯ä¸å¯ç”¨çš„.</p><p id="ee208595-a2c2-48c7-9d8a-b28bf23085ba" class="">ä»»ä½•ç”±è¯¥æŒ‡ä»¤åˆ›å»ºçš„æ–‡ä»¶æˆ–è€…ç›®å½•çš„UIDå’ŒGIDéƒ½ä¼šè®¾ç½®ä¸º0.</p><p id="344b8ee9-776c-4de8-814b-d0043f950282" class="">å¦‚æœæºè·¯å¾„æ˜¯ä¸€ä¸ªç›®å½•, é‚£ä¹ˆè¿™ä¸ªç›®å½•å°†æ•´ä¸ªè¢«å¤åˆ¶åˆ°å®¹å™¨ä¸­, åŒ…æ‹¬æ–‡ä»¶ç³»ç»Ÿå…ƒæ•°æ®.å¦‚æœæºæ–‡ä»¶ä¸ºä»»ä½•ç±»å‹çš„æ–‡ä»¶, åˆ™è¯¥æ–‡ä»¶ä¼šéšåŒå…ƒæ•°æ®ä¸€èµ·è¢«å¤åˆ¶.</p><p id="263eed09-5564-4212-8728-24e46737ab5e" class="">å¦‚æœç›®çš„ä½ç½®ä¸å­˜åœ¨, Dockerå°†ä¼šè‡ªåŠ¨åˆ›å»ºæ‰€æœ‰éœ€è¦çš„ç›®å½•ç»“æ„, å°±åƒ<code>mdkir -p</code>å‘½ä»¤é‚£æ ·.</p><hr id="c9af658a-3ad5-4037-ba15-bf7b1a52b7a7"/><h2 id="09f79cdc-5a9a-4c8a-96ab-2c5368a6512e" class="block-color-blue_background"><strong>LABEL</strong></h2><p id="907f16d0-d5ce-4083-8b90-374d85130494" class="">LABELæŒ‡ä»¤ç”¨äºä¸ºDockeré•œåƒæ·»åŠ å…ƒæ•°æ®(ä½œä¸ºæè¿°ä¿¡æ¯). å…ƒæ•°æ®ä»¥é”®å€¼å¯¹çš„å½¢å¼å±•ç°. æˆ‘ä»¬å¯ä»¥çœ‹ä¸€ä¸ªä¾‹å­, å¦‚ä¸‹æ‰€ç¤º:</p><figure id="2671f955-d4ae-40a2-8c40-6c9adb8da957" class="image"><a href="Dockerfile%20cf1d6/1575516713290.png"><img style="width:561px" src="Dockerfile%20cf1d6/1575516713290.png"/></a></figure><p id="96339f2d-9bc5-4deb-be55-667905ed69aa" class="">LABELæŒ‡ä»¤ä»¥label=&quot;value&quot;çš„å½¢å¼å‡ºç°. å¯ä»¥åœ¨æ¯ä¸€æ¡æŒ‡ä»¤ä¸­æŒ‡å®šä¸€ä¸ªå…ƒæ•°æ®, æˆ–è€…æŒ‡å®šå¤šä¸ªå…ƒæ•°æ®, ä¸åŒçš„å…ƒæ•°æ®ä¹‹é—´ç”¨ç©ºæ ¼åˆ†éš”. æ¨èå°†æ‰€æœ‰çš„å…ƒæ•°æ®éƒ½æ”¾åˆ°ä¸€æ¡LABELæŒ‡ä»¤ä¸­, ä»¥é˜²æ­¢ä¸åŒçš„å…ƒæ•°æ®æŒ‡ä»¤åˆ›å»ºè¿‡å¤šé•œåƒå±‚. å¯ä»¥é€šè¿‡<code>docker inspect</code>å‘½ä»¤æ¥æŸ¥çœ‹Dockeré•œåƒä¸­çš„æ ‡ç­¾ä¿¡æ¯.</p><pre id="13fa52ff-f181-404f-b8e5-e317fe618a92" class="code code-wrap"><code>Â [root@web02 simple_sh]# docker inspect  a2543d390494
Â ......
Â  Â  Â  Â  Â  Â   &quot;Labels&quot;: {
Â  Â  Â  Â  Â  Â  Â  Â   &quot;location&quot;: &quot;New York&quot;,
Â  Â  Â  Â  Â  Â  Â  Â   &quot;role&quot;: &quot;Web Server&quot;,
Â  Â  Â  Â  Â  Â  Â  Â   &quot;type&quot;: &quot;Data Center&quot;,
Â  Â  Â  Â  Â  Â  Â  Â   &quot;version&quot;: &quot;1.0&quot;
Â  Â  Â  Â  Â  Â   }
Â ......</code></pre><p id="7d31e179-43b0-44b2-84c4-0ebc63451de6" class="">è¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å‰é¢çš„LABELæŒ‡ä»¤å®šä¹‰çš„å…ƒæ•°æ®ä¿¡æ¯.</p><hr id="fe9e5ba2-8da7-4390-8964-77e6cc6eff16"/><h2 id="c01758c9-1d87-4c70-85de-4ace190bb6fd" class=""><strong>STOPSIGNAL(è·³è¿‡)</strong></h2><p id="38cfbb6c-8edb-41e5-90f1-a0e0849b96c1" class="">STOPSIGNALæŒ‡ä»¤ç”¨æ¥è®¾ç½®åœæ­¢å®¹å™¨æ—¶å‘é€ä»€ä¹ˆç³»ç»Ÿè°ƒç”¨ä¿¡å·ç»™å®¹å™¨. è¿™ä¸ªä¿¡å·å¿…é¡»æ˜¯å†…æ ¸ç³»ç»Ÿè°ƒç”¨è¡¨ä¸­åˆæ³•çš„æ•°, å¦‚9, æˆ–è€…SIGNAMEæ ¼å¼ä¸­çš„ä¿¡å·åç§°, å¦‚SIGKILL.</p><blockquote id="eb08d29f-f735-414f-a125-08a9d71f6804" class="">STOPSIGNALæŒ‡ä»¤æ˜¯åœ¨1.9ç‰ˆæœ¬ä¸­å¼•å…¥çš„.</blockquote><hr id="31e4dfdc-dbb3-4dad-864b-cc599e37c1d7"/><h2 id="d47b8259-40fc-43e9-ba56-43cace9f391f" class=""><strong>ARG</strong></h2><p id="0ed5930f-a5a3-4e6b-90bb-e8661e7174e5" class="">ARGå®šä¹‰&quot;<strong>åœ¨docker buildå‘½ä»¤è¿è¡Œæ—¶ä¼ é€’ç»™æ„å»ºè¿è¡Œæ—¶çš„å˜é‡</strong>&quot;, æˆ‘ä»¬åªéœ€åœ¨æ„å»ºæ—¶ä½¿ç”¨<code>--build-arg</code>é€‰é¡¹å³å¯. ç”¨æˆ·åªèƒ½åœ¨Dockerfileæ–‡ä»¶ä¸­å®šä¹‰è¿‡çš„å‚æ•°.</p><p id="80502e10-e25d-40db-b331-a466e425d4b0" class="">æ·»åŠ ARGæŒ‡ä»¤, å¦‚ä¸‹æ‰€ç¤º:</p><pre id="f42430f8-fb7b-4853-863b-63f4013bc835" class="code code-wrap"><code>Â ARG build
Â ARG webapp_user=user</code></pre><p id="e5dcbbf3-3b94-4200-8e27-0dfcb8c4090e" class="">ä¸Šé¢ä¸¤ä¸ªä¾‹å­ä¸­ç¬¬äºŒæ¡ARGæŒ‡ä»¤è®¾ç½®äº†ä¸€ä¸ªé»˜è®¤å€¼, å¦‚æœæ„å»ºæ—¶æ²¡æœ‰ä¸ºè¯¥å‚æ•°æŒ‡å®šå€¼, å°±ä¼šä½¿ç”¨è¿™ä¸ªé»˜è®¤å€¼, ä¸‹é¢æˆ‘ä»¬å°±æ¥çœ‹çœ‹å¦‚ä½•åœ¨docker buildä¸­ä½¿ç”¨è¿™äº›å‚æ•°.</p><pre id="0fe7b317-581d-4c96-9076-3a230740168c" class="code code-wrap"><code>Â docker build --build-arg build=1234 -t maxiaoyu/test .</code></pre><p id="6d5d13de-184a-422b-ab41-1b8feb4761be" class="">è¿™é‡Œæ„å»ºmaxiaoyu/testé•œåƒæ—¶, buildå˜é‡å°†ä¼šè®¾ç½®ä¸º1234, è€Œwebapp_userå˜é‡åˆ™ä¼šé›†æˆè®¾ç½®çš„é»˜è®¤å€¼user.</p><hr id="d1f93dbf-8718-4278-b8df-c4667cb3c280"/><h2 id="82900873-7160-427b-ba40-c1403e6a31cb" class=""><strong>ONBUILD(çœ‹åˆ°è¿™äº†)</strong></h2><p id="466576c5-ba75-4a30-8270-72963bcc403f" class="">ONBUILDæŒ‡ä»¤èƒ½ä¸ºé•œåƒæ·»åŠ è§¦å‘å™¨(trigger). å½“ä¸€ä¸ªé•œåƒè¢«ç”¨ä½œå…¶ä»–é•œåƒçš„åŸºç¡€é•œåƒæ—¶(æ¯”å¦‚ç”¨æˆ·çš„é•œåƒéœ€è¦ä»æŸæœªå‡†å¤‡å¥½çš„ä½ç½®æ·»åŠ æºä»£ç , æˆ–è€…ç”¨æˆ·éœ€è¦æ‰§è¡Œç‰¹å®šäºæ„å»ºé•œåƒçš„ç¯å¢ƒçš„æ„å»ºè„šæœ¬), è¯¥é•œåƒä¸­çš„è§¦å‘å™¨å°†ä¼šè¢«æ‰§è¡Œ</p><p id="ba60afad-a208-4e03-80c5-833fcf5742da" class="">è§¦å‘å™¨ä¼šåœ¨æ„å»ºè¿‡ç¨‹ä¸­æ’å…¥æ–°æŒ‡ä»¤, æˆ‘ä»¬å¯ä»¥è®¤ä¸ºè¿™äº›æŒ‡ä»¤æ˜¯ç´§è·Ÿåœ¨FROMä¹‹åæŒ‡å®šçš„. è§¦å‘å™¨å¯ä»¥æ˜¯ä»»ä½•æ„å»ºæŒ‡ä»¤, å¦‚ä¸‹æ‰€ç¤º:</p><pre id="5133d1b0-cf91-42f3-a79e-d71aa3404c22" class="code code-wrap"><code>Â ONBUILD ADD . /app/src
Â ONBUILD RUN cd /app/src &amp;&amp; make</code></pre><p id="b6fc8373-e3aa-4b33-9355-51e3bf7f8447" class="">ä¸Šé¢çš„ä»£ç å°†ä¼šåœ¨åˆ›å»ºçš„é•œåƒä¸­åŠ å…¥ONBUILDè§¦å‘å™¨, ONBUILDæŒ‡ä»¤å¯ä»¥åœ¨é•œåƒä¸Šè¿è¡Œ<code>docker inspect</code>å‘½ä»¤æ¥æŸ¥çœ‹. å¦‚ä»£ç æ¸…å•</p><pre id="2b6f656e-d823-435f-91b6-2ce306b167d8" class="code code-wrap"><code>Â docker inspect ac05ec83ea6a
Â .....
Â  Â  Â  Â  Â  Â   &quot;OnBuild&quot;: [
Â  Â  Â  Â  Â  Â  Â  Â   &quot;ADD . /app/src&quot;,
Â  Â  Â  Â  Â  Â  Â  Â   &quot;RUN cd /app/src &amp;&amp; make&quot;
Â  Â  Â  Â  Â  Â   ],
Â 
Â .....</code></pre><p id="4eced7a1-ae8a-4896-ad65-3d0d4207e9fa" class="">æ¯”å¦‚, æˆ‘ä»¬ä¸ºApache2é•œåƒæ„å»ºä¸€ä¸ªå…¨æ–°çš„Dockerfile, è¯¥é•œåƒåä¸ºmaxiaoyu/apache2, å¦‚ä¸‹æ‰€ç¤º:</p><pre id="78fb48ea-73b7-4824-b7b2-a8a0eac9d307" class="code code-wrap"><code>Â FROM ubuntu:14.04
Â MAINTAINER Ma Xiaoyu &quot;xiao_yu_ma@hotmail.com&quot;
Â RUN apt-get update &amp;&amp; apt-get install -y apache2
Â ENV APACHE_RUN_USER www-data
Â ENV APACHE_RUN_GROUP www-data
Â ENV APACHE_LOG_DIR /var/log/apache2
Â ONBUILD ADD . /var/www/
Â EXPOSE 80
Â ENTRYPOINT [&quot;/usr/sbin/apache2&quot;]
Â CMD [&quot;-D&quot;, &quot;FOREGROUND&quot;]</code></pre><p id="4d0f099e-a605-45f8-aa85-ddd1f57ff03f" class="">ç°åœ¨æˆ‘ä»¬å°±æ¥æ„å»ºè¯¥é•œåƒ, å¦‚ä¸‹æ‰€ç¤º:</p><pre id="50b29693-c6ea-4b32-a9fc-f4c294acbabb" class="code code-wrap"><code>Â docker build -t=&quot;maxiaoyu/apache2:webserver&quot; .
Â .......
Â Step 7/10 : ONBUILD add . /var/www/
Â  ---&gt; Running in b8bdd04908cc
Â  ---&gt; 52a372cb8867
Â  .....</code></pre><p id="b45a1fbb-0e44-41a0-8369-5bd8f7a69a97" class="">åœ¨æ–°æ„å»ºçš„é•œåƒä¸­åŒ…å«ä¸€æ¡ONBUILDæŒ‡ä»¤, è¯¥æŒ‡ä»¤ä¼šä½¿ç”¨ADDæŒ‡ä»¤å°†æ„å»ºç¯å¢ƒæ‰€åœ¨çš„ç›®å½•ä¸‹çš„å†…å®¹å…¨éƒ¨æ·»åŠ åˆ°é•œåƒä¸­/var/wwwç›®å½•ä¸‹. æˆ‘ä»¬å¯ä»¥è½»è€Œæ˜“ä¸¾åœ°å°†è¿™Dockerfileä½œä¸ºä¸€ä¸ªé€šç”¨çš„Webåº”ç”¨ç¨‹åºçš„æ¨¡æ¿, å¯ä»¥åŸºäºè¿™ä¸ªæ¨¡æ¿æ¥æ„å»ºWebåº”ç”¨ç¨‹åº.</p><p id="21560bac-69cf-4677-b897-75e7323a6b55" class="">æˆ‘ä»¬å¯ä»¥é€šè¿‡æ„å»ºä¸€ä¸ªåä¸ºwebappçš„é•œåƒæ¥çœ‹çœ‹å¦‚ä½•ä½¿ç”¨é•œåƒæ¨¡æ¿åŠŸèƒ½. å®ƒçš„Dockerfileå¦‚ä¸‹æ‰€ç¤º:</p><pre id="5d3544e0-4110-4c71-b589-5b0db0aa7e26" class="code code-wrap"><code>Â FROM maxiaoyu/apache2
Â MAINTAINER Ma Xiaoyu &quot;xiao_yu_ma@hotmail.com&quot;
Â ENV APPLICATION_NAME webapp
Â ENV ENVIROMENT development
Â </code></pre><p id="090b29fb-f6cb-40cb-b500-59bc4de9983d" class="">è®©æˆ‘ä»¬çœ‹çœ‹æ„å»ºè¿™ä¸ªé•œåƒæ—¶å°†ä¼šå‘ç”Ÿä»€ä¹ˆäº‹æƒ….</p><figure id="94b8d7af-4150-4c3d-9375-725c5973e463" class="image"><a href="file://C:/Users/dell/AppData/Roaming/Typora/typora-user-images/1575519827653.png?lastModify=1616316457"><img src="file://C:/Users/dell/AppData/Roaming/Typora/typora-user-images/1575519827653.png?lastModify=1616316457"/></a></figure><p id="237f4f44-731d-4c5a-bb78-5e269ad2911b" class="">å¯ä»¥æ¸…æ¥šåœ°çœ‹åˆ°, åœ¨FROMæŒ‡ä»¤ä¹‹å, Dockeræ’å…¥äº†ä¸€æ¡ADDæŒ‡ä»¤, è¿™æ¡ADDæŒ‡ä»¤å°±æ˜¯åœ¨ONBUILDè§¦å‘å™¨ä¸­æŒ‡å®šçš„. æ‰§è¡Œå®Œè¯¥ADDæŒ‡ä»¤å, Dockeræ‰ä¼šç»§ç»­æ‰§è¡Œæ„å»ºæ–‡ä»¶çš„åç»­æŒ‡ä»¤, è¿™ç§æœºåˆ¶ä½¿æˆ‘æ¯æ¬¡éƒ½ä¼šå°†æœ¬åœ°æºä»£ç æ·»åŠ åˆ°é•œåƒ, å°±åƒä¸Šé¢æˆ‘ä»¬åšåˆ°	çš„å‘æ ·, ä¹Ÿæ”¯æŒæˆ‘ä¸ºä¸åŒçš„åº”ç”¨ç¨‹åºè¿›è¡Œä¸€äº›ç‰¹å®šçš„é…ç½®æˆ–è€…è®¾ç½®æ„å»ºä¿¡æ¯. è¿™æ—¶, å¯ä»¥å°†maxiaoyu/maxiaoyu2å½“ä½œä¸€ä¸ªé•œåƒæ¨¡æ¿åŠŸèƒ½.</p><p id="2fa964c0-44cd-4b57-b98d-b0adc1d84cb8" class="">ONBUILDè§¦å‘å™¨ä¼šæŒ‰ç…§åœ¨çˆ¶é•œåƒä¸­æŒ‡å®šçš„é¡ºåºæ‰§è¡Œ, å¹¶ä¸”åªèƒ½è¢«ç»§æ‰¿ä¾æ¬¡(ä¹Ÿå°±æ˜¯è¯´åªèƒ½åœ¨ç´«è†æƒ³ä¸­æ‰§è¡Œ, è€Œä¸ä¼šåœ¨å­™å­é•œåƒä¸­æ‰§è¡Œ).å¦‚æœå†åŸºäº<code>maxiaoyu/webapp</code>æ„å»ºä¸€ä¸ªé•œåƒ, åˆ™æ–°é•œåƒæ˜¯<code>maxiaoyu/apache2</code>çš„å­™å­é•œåƒ, å› æ­¤åœ¨è¯¥é•œåƒçš„æ„å»ºè¿‡ç¨‹ä¸­. ONBUILDè§¦å‘å™¨æ˜¯ä¸ä¼šè¢«æ‰§è¡Œçš„.</p><blockquote id="c1e940e1-29f8-4776-b261-b548f98105b8" class="">æ³¨æ„:è¿™é‡Œå¥½å‡ æ¡æŒ‡ä»¤æ˜¯ä¸èƒ½ç”¨åœ¨ONBUILDæŒ‡ä»¤ä¸­çš„, åŒ…æ‹¬FROM, MAINTAINERå’ŒONBUILDæœ¬èº«. ä¹‹æ‰€ä»¥è¿™ä¹ˆè§„å®šæ˜¯ä¸ºäº†é˜²æ­¢åœ¨Dockerfileæ„å»ºè¿‡ç¨‹ä¸­äº§ç”Ÿé€’å½’è°ƒç”¨çš„é—®é¢˜.</blockquote><hr id="c08abd53-9f04-4907-9925-4bfbfd2d4509"/><h1 id="4196e044-540e-4499-a54e-1bc06a3f17f1" class=""><strong>å¤šé˜¶æ®µé•œåƒæ„å»ºæŠ€æœ¯</strong></h1><p id="76858a64-adf9-4975-a8b8-d8631f8d75c3" class="">å¤šé˜¶æ®µé•œåƒæ„å»ºå¯ä»¥é€šè¿‡ä¸€ä¸ªDockerfileï¼Œä¸€æ¬¡æ€§åœ°ã€æ›´å®¹æ˜“åœ°<strong>æ„å»ºå‡ºsizeè¾ƒå°çš„image</strong>ï¼Œä½“éªŒè‰¯å¥½å¹¶ä¸”æ›´å®¹æ˜“æ¥å…¥CI/CDç­‰è‡ªåŠ¨åŒ–ç³»ç»Ÿã€‚</p><ul id="de8815d4-af26-4903-a298-878dad05b6a1" class="bulleted-list"><li style="list-style-type:disc">æ”¯æŒMulti-stage buildçš„Dockerfileåœ¨ä»¥å¾€çš„å¤šä¸ªbuildé˜¶æ®µä¹‹é—´å»ºç«‹å†…åœ¨è¿æ¥ï¼Œè®©åä¸€ä¸ªé˜¶æ®µæ„å»ºå¯ä»¥ä½¿ç”¨å‰ä¸€ä¸ªé˜¶æ®µæ„å»ºçš„äº§ç‰©ï¼Œå½¢æˆä¸€æ¡æ„å»ºé˜¶æ®µçš„chainï¼›</li></ul><ul id="3c4a86de-e279-43ee-b2d4-247dacc17e6b" class="bulleted-list"><li style="list-style-type:disc">Multi-stages buildçš„æœ€ç»ˆç»“æœä»…äº§ç”Ÿä¸€ä¸ªimageï¼Œé¿å…äº§ç”Ÿå†—ä½™çš„å¤šä¸ªä¸´æ—¶imagesæˆ–ä¸´æ—¶å®¹å™¨å¯¹è±¡ï¼Œè¿™æ­£æ˜¯æˆ‘ä»¬æ‰€éœ€è¦çš„ï¼šæˆ‘ä»¬åªè¦ç»“æœã€‚</li></ul><p id="65bb94cd-5c8c-409b-8787-b62862d4aedc" class="">å¤šé˜¶æ®µæ„å»ºä»…åœ¨Docker 17.05åŠä¹‹åçš„ç‰ˆæœ¬ä¸­æ‰èƒ½å¾—åˆ°æ”¯æŒã€‚</p><p id="89981a7e-33d7-4f5c-91c6-06973d166c01" class="">ä¸‹é¢æ˜¾ç¤ºäº†å¤šé˜¶æ®µé•œåƒæ„å»ºçš„æ•ˆæœ. v2é‡‡ç”¨äº†å¤šé˜¶æ®µæ„å»º,ç²¾ç®€äº†ä»…100Mçš„ç©ºé—´.</p><pre id="f0d8f53d-38f2-4a5c-bd70-6d59c80dd0a8" class="code code-wrap"><code>Â redis-5.0.7 Â  Â  Â  Â  v2 Â  Â  Â  Â  Â  Â  Â  Â   28fa10e7fdfb Â  Â  Â   4 seconds ago Â  Â  Â  231MB
Â redis-5.0.7 Â  Â  Â  Â  v1 Â  Â  Â  Â  Â  Â  Â  Â   7409144dda9e Â  Â  Â   About an hour ago Â  329MB</code></pre><h3 id="92efae4f-fa1b-4d06-8b85-f2f952cb825a" class=""><strong>å®ç°</strong></h3><p id="6a9629a3-b3ad-4939-a2c6-4b5dc321d3ad" class="">ä¸‹é¢æ“ä½œåˆ†ä¸ºäº†ä¸¤ä¸ªé˜¶æ®µ. ç¬¬ä¸€ä¸ªé˜¶æ®µè´Ÿè´£ç¼–è¯‘rediså¹¶åœ¨/usr/local/redisç›®å½•ä¸‹ç”Ÿæˆç¼–è¯‘ç»“æœ. ç¬¬äºŒé˜¶æ®µæ‹·è´ç¬¬ä¸€é˜¶æ®µçš„ç¼–è¯‘ç»“æœ. å› ä¸ºç¬¬äºŒé˜¶æ®µçš„é•œåƒæ˜¯çº¯å‡€çš„,ç©ºé—´æ›´å°,å°†redisç¼–è¯‘ç»“æœæ‹¿æ¥å³å¯ä½¿ç”¨.è¿™å°±æ˜¯å¤šé˜¶æ®µé•œåƒæ„å»ºæŠ€æœ¯çš„æ ¸å¿ƒæ€æƒ³.</p><p id="13347091-c9c4-4f18-a59b-6e548980e52e" class="">ä¸‹é¢å¤šé˜¶æ®µé•œåƒæ„å»ºçš„æ ¸å¿ƒå‘½ä»¤æ˜¯ç¬¬ä¸€é˜¶æ®µ<code>FROM</code>å‘½ä»¤å’Œç¬¬äºŒé˜¶æ®µ<code>FROM</code>å‘½ä»¤åŠ<code>COPY</code>å‘½ä»¤</p><pre id="caff944e-65b8-4c8e-9605-a31e1b2f3101" class="code code-wrap"><code>Â FROM ubuntu:14.04 as builder
Â COPY sources.list /etc/apt/
Â COPY redis-5.0.7.tar.gz /root/
Â RUN apt-get update \
Â  Â   &amp;&amp; apt-get -yqq install make gcc \
Â  Â   &amp;&amp; cd /root &amp;&amp; tar xf redis-5.0.7.tar.gz \
Â  Â   &amp;&amp; cd redis-5.0.7 &amp;&amp; make &amp;&amp; make PREFIX=/usr/local/redis install \
Â  Â   &amp;&amp; apt-get -yqq remove make gcc \
Â  Â   &amp;&amp; apt-get clean all \
Â  Â   &amp;&amp; cd / &amp;&amp; rm -rf /root/redis-5.0.7*
Â 
Â FROM ubuntu:14.04
Â COPY --from=builder /usr/local/redis /usr/local/
Â RUN mkdir -p /opt/redis/conf/ \
Â  Â   &amp;&amp; mkdir /opt/redis/pid \
Â  Â   &amp;&amp; mkdir /opt/redis/log \
Â  Â   &amp;&amp; mkdir /data/
Â COPY redis.conf /opt/redis/conf/
Â EXPOSE 6379
Â CMD [&quot;/bin/sh&quot;,&quot;-c&quot;,&quot;redis-server /opt/redis/conf/redis.conf&quot;]
Â #build-essential</code></pre><h1 id="60b542ce-9938-4555-9c60-fc6c85f8b32c" class="">shell formä¸ exec formåŒºåˆ«æ€»ç»“</h1><ol type="1" id="6e9077ad-c39f-4618-8fd0-85b0ee927760" class="numbered-list" start="1"><li>æ ¼å¼  shell form: <code>&lt;command&gt;</code>, exec form: <code>[&quot;å‘½ä»¤&quot;, &quot;å‚æ•°1&quot;, &quot;å‚æ•°2&quot;]</code></li></ol><ol type="1" id="c8036651-c0af-4d52-900a-626260eb395d" class="numbered-list" start="2"><li>RUN, CMD, ENTRYPOINTéƒ½å¯ä½¿ç”¨shell formå’Œexec form<p id="4f770dad-b601-44fa-81bd-07fad352f451" class="">å»ºè®®RUNç”¨shell formï¼›CMDå’ŒENTRYPOINTç”¨exec form</p></li></ol><ol type="1" id="b2433a06-9450-41f5-9f4a-f2a09bd65f07" class="numbered-list" start="3"><li>shell form äº¤ç»™shellè¿è¡Œï¼Œåœ¨æŸäº›æƒ…å†µä¼šé€ æˆä¸è‰¯åæœï¼›exec formé‡‡ç”¨<code>[]</code>ï¼Œç¨‹åºç›´æ¥è¿è¡Œï¼Œä¸ä½œä¸ºshellå­ç¨‹åº</li></ol><ol type="1" id="a5d7b350-1598-4045-a982-e17fce665855" class="numbered-list" start="4"><li>shell formæ˜¯shellè¯­å¥ï¼Œæ•…å¯ç”¨shellå‘½ä»¤çš„ç‰¹æ€§å¦‚å˜é‡æ›¿æ¢/å‘½ä»¤é“¾(&amp;&amp;æˆ–/)/é‡å®šå‘/ç®¡é“<p id="3b094fbe-4b52-4de7-bc57-a7faca7a6588" class="">exec formæ˜¯ç›´æ¥æ‰§è¡Œå‘½ä»¤ï¼Œä¸ç»è¿‡shellï¼Œæ•…ä¸å¯ç”¨ä»¥ä¸Šshellç‰¹æ€§ã€‚<div class="indented"><p id="d9c30a05-81bd-4bb6-9edf-0816e5ba0bd0" class="">è¡¥å……ï¼šæ— æ³•å¼•ç”¨shellç¯å¢ƒå˜é‡ï¼Œå¦‚éœ€è¦åˆ™åŠ å…¥<code>/bin/sh -c</code>ï¼Œå¦‚<code>[&quot;/bin/sh&quot;,&quot;-c&quot;,&quot;echo ${TEST}&quot;]</code>ï¼ŒæŒ‡æ˜äº¤ç»™shellå¤„ç†åˆ™å¯å¼•ç”¨å˜é‡</p></div></p></li></ol><ol type="1" id="16a8ac82-bb0d-4dc0-8a39-a157eca3a2b7" class="numbered-list" start="5"><li>exec formæ ¼å¼ï¼š <code>[&quot;å‘½ä»¤&quot;, &quot;å‚æ•°1&quot;, &quot;å‚æ•°2&quot;]</code>  ğŸ‘ï¸â€ğŸ—¨ï¸è®°ä½å¿…é¡»åŒå¼•å·. ä¾‹:<code>ENTRYPOINT [&quot;sh&quot;, &quot;test.sh&quot;]</code> :<ul id="c2755c2f-6933-4bd8-bc6d-119e6d6bc763" class="bulleted-list"><li style="list-style-type:disc"><code>[&quot;sh&quot;, &quot;test.sh&quot;]</code> ç¬¬ä¸€è¿›ç¨‹æ˜¯<code>&quot;sh test.sh&quot;</code>; </li></ul><ul id="9ed8d86f-f5a1-429c-a348-1081a62234b4" class="bulleted-list"><li style="list-style-type:disc"><code>[&quot;/bin/sh&quot;,&quot;-c&quot;, &quot;sh test.sh&quot;]</code>ç¬¬ä¸€è¿›ç¨‹æ˜¯<code>&quot;/bin/sh&quot;,&quot;-c&quot;, &quot;sh test.sh</code>ï¼Œç¬¬äºŒè¿›ç¨‹æ‰æ˜¯<code>&quot;sh test.sh&quot;</code></li></ul><ul id="6c859497-573b-46a5-bb13-ebe2a50165e1" class="bulleted-list"><li style="list-style-type:disc">åè€…æœ‰ä¸ªä¾‹å¤–ï¼šalpineé•œåƒï¼Œ[&quot;/bin/sh&quot;,&quot;-c&quot;,&quot;sh test.sh&quot;] ç¬¬ä¸€è¿›ç¨‹æ˜¯â€œ<code>sh test.sh</code>â€ï¼ŒåŸå› ï¼š<ul id="b1dc7a7e-8077-4c67-b31a-09a40ce8594c" class="bulleted-list"><li style="list-style-type:circle">è¿™æ˜¯ashçš„ä½œç”¨ï¼Œalpineçš„/bin/shå®é™…æ˜¯ash(busybox )ï¼Œå½“æ‰§è¡Œç¨‹åºæ˜¯/bin/sh, å®ƒå°±ä¼šè¢«åé¢çš„<code>sh test.sh</code>å‘½ä»¤æ›¿æ¢ï¼Œç¬¬ä¸€è¿›ç¨‹æ˜¯<code>sh test.sh</code>ï¼Œè€Œä¸ä¼šåˆ›å»ºä¸€ä¸ªå­è¿›ç¨‹<code>sh test.sh</code></li></ul></li></ul></li></ol><p id="f8d435fe-68ba-4ee5-abf3-da6adfe2705f" class="">
</p></div></article></body></html>